<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RES HQ - Interactive Mockup & Technical Specification</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header-content p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .user-info {
            text-align: right;
        }

        .user-role {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 6px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .logout-btn {
            background: rgba(255,255,255,0.3);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* Main Navigation */
        .main-nav {
            display: flex;
            background: white;
            border-radius: 8px;
            padding: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            gap: 8px;
        }

        .main-nav-tab {
            flex: 1;
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .main-nav-tab.active {
            background: #2563eb;
            color: white;
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
        }

        .main-nav-tab:hover:not(.active) {
            background: #f1f5f9;
            color: #2563eb;
        }

        /* Sub Navigation */
        .sub-nav {
            display: none;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            gap: 8px;
            flex-wrap: wrap;
        }

        .sub-nav.active {
            display: flex;
        }

        .sub-nav-tab {
            padding: 8px 16px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            color: #475569;
        }

        .sub-nav-tab.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .sub-nav-tab:hover:not(.active) {
            background: #eff6ff;
            border-color: #3b82f6;
        }

        .role-view {
            display: none;
        }

        .role-view.active {
            display: block;
        }

        .sub-view {
            display: none;
        }

        .sub-view.active {
            display: block;
        }

        .panel {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }

        .panel h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .panel h3 {
            color: #475569;
            margin: 20px 0 12px 0;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .panel h4 {
            color: #64748b;
            margin: 16px 0 8px 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .grid {
            display: grid;
            gap: 20px;
            margin-bottom: 20px;
        }

        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-3 { grid-template-columns: 1fr 1fr 1fr; }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-5 { grid-template-columns: repeat(5, 1fr); }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #2563eb;
        }

        .stat-card.clickable {
            cursor: pointer;
            transition: all 0.2s;
        }

        .stat-card.clickable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-card h4 {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1e293b;
        }

        .stat-card small {
            color: #64748b;
            font-size: 0.85rem;
        }

        .stat-link {
            color: #2563eb;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 8px;
            display: inline-block;
        }

        .stat-link:hover {
            color: #1d4ed8;
        }

        .table-container {
            background: white;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #e2e8f0;
            margin: 16px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8fafc;
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: #475569;
            border-bottom: 2px solid #e2e8f0;
            font-size: 0.9rem;
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid #f1f5f9;
            color: #334155;
        }

        tr:hover {
            background: #f8fafc;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .status-badge.status-not-started {
            background: #fef3c7;
            color: #92400e;
        }

        .status-badge.status-in-progress {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .status-badge.status-complete {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.status-blocked {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-badge.status-error {
            background: #fee2e2;
            color: #991b1b;
        }

        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }

        .btn:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .btn-sm {
            padding: 4px 12px;
            font-size: 0.85rem;
        }

        .btn-secondary {
            background: #64748b;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .btn-success {
            background: #059669;
        }

        .btn-warning {
            background: #d97706;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
            border-left: 4px solid;
        }

        .alert-info {
            background: #eff6ff;
            border-color: #2563eb;
            color: #1e40af;
        }

        .alert-success {
            background: #f0fdf4;
            border-color: #059669;
            color: #065f46;
        }

        .alert-warning {
            background: #fffbeb;
            border-color: #d97706;
            color: #92400e;
        }

        .progress-bar {
            background: #f1f5f9;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            transition: width 0.3s ease;
        }

        .project-card {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .milestone-diamond {
            width: 12px;
            height: 12px;
            background: #f59e0b;
            transform: rotate(45deg);
            display: inline-block;
            margin-right: 8px;
        }

        .project-details-card {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .menu-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 20px;
        }

        .menu-item {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .menu-item:hover {
            border-color: #3b82f6;
            background: #eff6ff;
            transform: translateY(-2px);
        }

        .menu-item h3 {
            margin: 0;
            font-size: 1.1rem;
        }

        .error-row {
            background: #fef2f2;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4, .grid-5 {
                grid-template-columns: 1fr;
            }
            
            .main-nav {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>🌿 RES HQ - Project Management System</h1>
                <p>Interactive Mockup & Technical Specification</p>
                <p style="font-size: 1rem; margin-top: 10px; opacity: 0.8;">
                    Custom JS UI • Supabase Backend • NetSuite Integration
                </p>
            </div>
            <div class="user-info">
                <div class="user-role" id="user-role-display">PM: Sarah Chen</div>
            </div>
        </div>

        <!-- Main Navigation (Role-Based) -->
        <div class="main-nav">
            <button class="main-nav-tab active" onclick="showRole('pm')">📊 PM</button>
            <button class="main-nav-tab" onclick="showRole('rm')">👥 RM</button>
            <button class="main-nav-tab" onclick="showRole('employee')">👤 Employee</button>
            <button class="main-nav-tab" onclick="showRole('leadership')">📈 Leadership</button>
            <button class="main-nav-tab" onclick="showRole('admin')">⚙️ Admin</button>
            <button class="main-nav-tab" onclick="showRole('dev')">🔧 Dev</button>
        </div>

        <!-- Sub Navigation (Project-Level) -->
        <div class="sub-nav" id="project-sub-nav">
            <div style="flex: 1; display: flex; align-items: center; gap: 8px;">
                <strong style="color: #1e293b;">Selected:</strong>
                <span id="selected-project-name" style="color: #2563eb; font-weight: 600;">Salmon Creek Restoration (SLM-2025-003)</span>
            </div>
            <button class="sub-nav-tab active" onclick="showSubView('project-details')">📋 Details</button>
            <button class="sub-nav-tab" onclick="showSubView('work-items')">🏗️ Work Items</button>
            <button class="sub-nav-tab" onclick="showSubView('milestones')">💎 Milestones</button>
            <button class="sub-nav-tab" onclick="showSubView('timeline')">📊 Timeline</button>
            <button class="sub-nav-tab" onclick="showSubView('cost-items')">💰 Cost Items</button>
            <button class="sub-nav-tab" onclick="showSubView('cost-timeline')">📈 Cost Timeline</button>
            <button class="sub-nav-tab" onclick="showSubView('resource-requests')">📝 Requests</button>
            <button class="sub-nav-tab" onclick="showSubView('assignments')">👥 Assignments</button>
            <button class="sub-nav-tab" onclick="showSubView('contract-history')">📄 History</button>
            <button class="sub-nav-tab" onclick="showSubView('task-changes')">🔄 TCRs</button>
        </div>

        <!-- PM ROLE VIEW -->
        <div id="pm-view" class="role-view active">
            
            <!-- Projects Dashboard (Default View) -->
            <div id="pm-projects-dashboard" class="sub-view active">
                <div class="panel">
                    <h2>📁 Projects Dashboard</h2>
                    
                    <div class="alert alert-info">
                        <strong>PM: Sarah Chen</strong> • 12 projects loaded • Pacific Northwest region
                    </div>

                    <div class="grid grid-5">
                        <div class="stat-card">
                            <h4>Total Projects</h4>
                            <div class="value">12</div>
                        </div>
                        <div class="stat-card">
                            <h4>Avg Budget Health</h4>
                            <div class="value" style="color: #059669;">92%</div>
                            <small>Under budget avg</small>
                        </div>
                        <div class="stat-card clickable" onclick="showSubView('pm-milestones-all')">
                            <h4>Overdue Milestones</h4>
                            <div class="value" style="color: #dc2626;">3</div>
                            <a class="stat-link" onclick="event.stopPropagation(); showSubView('pm-milestones-all')">View Milestones →</a>
                        </div>
                        <div class="stat-card clickable" onclick="showSubView('pm-requests-all')">
                            <h4>Open Resource Requests</h4>
                            <div class="value" style="color: #d97706;">8</div>
                            <a class="stat-link" onclick="event.stopPropagation(); showSubView('pm-requests-all')">View Requests →</a>
                        </div>
                        <div class="stat-card clickable" onclick="showSubView('pm-errors')">
                            <h4>Errors</h4>
                            <div class="value" style="color: #dc2626;">5</div>
                            <a class="stat-link" onclick="event.stopPropagation(); showSubView('pm-errors')">View Errors →</a>
                        </div>
                    </div>

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 12px;">
                        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                            <button class="btn" onclick="alert('Create New Project modal')">+ New Project</button>
                            <button class="btn btn-secondary" onclick="showSubView('pm-copy-project')">📄 Copy Project</button>
                            <button class="btn btn-success" onclick="alert('Generate Forecast Report - CRITICAL Must Have V1')">📊 Generate Forecast</button>
                            <select class="form-control" style="width: auto;">
                                <option>All Projects</option>
                                <option>⭐ Favorites Only</option>
                                <option>Active</option>
                                <option>Blocked</option>
                            </select>
                        </div>
                    </div>

                    <h3>My Projects</h3>
                    <div class="grid grid-3">
                        <div class="panel project-card" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-left: 4px solid #059669;" onclick="selectProject('SLM-2025-003', 'Salmon Creek Restoration')">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h3 style="margin: 0; color: #1e293b;">Salmon Creek Restoration</h3>
                                    <small style="color: #64748b;">SLM-2025-003</small>
                                </div>
                                <button class="btn btn-sm" style="padding: 4px 8px; background: transparent; color: #f59e0b; font-size: 1.2rem;" onclick="event.stopPropagation(); toggleFavorite(event)">⭐</button>
                            </div>
                            <div style="margin: 8px 0;">
                                <span class="status-badge status-in-progress">In Progress</span>
                            </div>
                            <div style="margin: 12px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <small style="color: #64748b;">Budget Status</small>
                                    <small style="color: #059669; font-weight: 600;">Under Budget</small>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 73%; background: #059669;"></div>
                                </div>
                                <small style="color: #64748b;">$247K / $340K (73%)</small>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Next Milestone:</span>
                                    <span style="color: #1e293b; font-weight: 600;">Aug 12</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Open Requests:</span>
                                    <span style="color: #d97706; font-weight: 600;">2</span>
                                </div>
                            </div>
                        </div>

                        <div class="panel project-card" style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border-left: 4px solid #dc2626;" onclick="selectProject('WWB-2025-018', 'Willow Wetland Banking')">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h3 style="margin: 0; color: #1e293b;">Willow Wetland Banking</h3>
                                    <small style="color: #64748b;">WWB-2025-018</small>
                                </div>
                                <button class="btn btn-sm" style="padding: 4px 8px; background: transparent; color: #d1d5db; font-size: 1.2rem;" onclick="event.stopPropagation(); toggleFavorite(event)">☆</button>
                            </div>
                            <div style="margin: 8px 0;">
                                <span class="status-badge status-blocked">Blocked</span>
                            </div>
                            <div style="margin: 12px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <small style="color: #64748b;">Budget Status</small>
                                    <small style="color: #dc2626; font-weight: 600;">Over Budget</small>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 110%; background: #dc2626;"></div>
                                </div>
                                <small style="color: #64748b;">$182K / $165K (110%)</small>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Next Milestone:</span>
                                    <span style="color: #dc2626; font-weight: 600;">Overdue</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Open Requests:</span>
                                    <span style="color: #64748b; font-weight: 600;">0</span>
                                </div>
                            </div>
                        </div>

                        <div class="panel project-card" style="background: linear-gradient(135deg, #fffbeb, #fef3c7); border-left: 4px solid #d97706;" onclick="selectProject('CSE-2025-024', 'Cascade Stream Enhancement')">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h3 style="margin: 0; color: #1e293b;">Cascade Stream Enhancement</h3>
                                    <small style="color: #64748b;">CSE-2025-024</small>
                                </div>
                                <button class="btn btn-sm" style="padding: 4px 8px; background: transparent; color: #f59e0b; font-size: 1.2rem;" onclick="event.stopPropagation(); toggleFavorite(event)">⭐</button>
                            </div>
                            <div style="margin: 8px 0;">
                                <span class="status-badge status-not-started">Not Started</span>
                            </div>
                            <div style="margin: 12px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <small style="color: #64748b;">Budget Status</small>
                                    <small style="color: #64748b; font-weight: 600;">Planning</small>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 0%; background: #d97706;"></div>
                                </div>
                                <small style="color: #64748b;">$0 / $890K (0%)</small>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Next Milestone:</span>
                                    <span style="color: #1e293b; font-weight: 600;">Aug 15</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                                    <span style="color: #64748b;">Open Requests:</span>
                                    <span style="color: #d97706; font-weight: 600;">5</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- All Milestones View -->
            <div id="pm-milestones-all" class="sub-view">
                <div class="panel">
                    <h2>💎 All Milestones (All Projects)</h2>
                    <button class="btn btn-secondary" onclick="showSubView('pm-projects-dashboard')">← Back to Dashboard</button>
                    
                    <div class="table-container" style="margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Milestone</th>
                                    <th>Due Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fee2e2;">
                                    <td>Willow Wetland Banking</td>
                                    <td>Land Acquisition</td>
                                    <td style="color: #dc2626; font-weight: 600;">Aug 8 (Overdue)</td>
                                    <td>$20,000</td>
                                    <td><span class="status-badge status-blocked">Overdue</span></td>
                                </tr>
                                <tr>
                                    <td>Salmon Creek Restoration</td>
                                    <td>Permit Review Complete</td>
                                    <td>Aug 12</td>
                                    <td>$15,000</td>
                                    <td><span class="status-badge status-in-progress">Upcoming</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- All Resource Requests View -->
            <div id="pm-requests-all" class="sub-view">
                <div class="panel">
                    <h2>📝 All Resource Requests (All Projects)</h2>
                    <button class="btn btn-secondary" onclick="showSubView('pm-projects-dashboard')">← Back to Dashboard</button>
                    
                    <div class="table-container" style="margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Work Item</th>
                                    <th>Generic Resource</th>
                                    <th>Hours</th>
                                    <th>Start Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fef3c7;">
                                    <td>Salmon Creek</td>
                                    <td>Environmental Impact</td>
                                    <td>Ecologist II</td>
                                    <td>120 hrs</td>
                                    <td>Jul 1</td>
                                    <td><span class="status-badge status-not-started">Unfilled</span></td>
                                </tr>
                                <tr style="background: #fef3c7;">
                                    <td>Cascade Stream</td>
                                    <td>Site Assessment</td>
                                    <td>Ecologist I</td>
                                    <td>80 hrs</td>
                                    <td>Aug 15</td>
                                    <td><span class="status-badge status-not-started">Unfilled</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Errors Dashboard -->
            <div id="pm-errors" class="sub-view">
                <div class="panel">
                    <h2>⚠️ Data Validation Errors</h2>
                    <button class="btn btn-secondary" onclick="showSubView('pm-projects-dashboard')">← Back to Dashboard</button>
                    
                    <div class="alert alert-warning" style="margin-top: 20px;">
                        <strong>5 errors found</strong> across Work Items, Cost Items, and Assignments
                    </div>

                    <h3>Work Item Errors</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Work Item</th>
                                    <th>Error</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="error-row">
                                    <td>Willow Wetland</td>
                                    <td>Land Assessment</td>
                                    <td style="color: #dc2626;">Start Date (9/1) after End Date (8/15)</td>
                                    <td><button class="btn btn-sm">Fix</button></td>
                                </tr>
                                <tr class="error-row">
                                    <td>Cascade Stream</td>
                                    <td>Permitting</td>
                                    <td style="color: #dc2626;">Marked Complete but Start Date in future (10/1)</td>
                                    <td><button class="btn btn-sm">Fix</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Cost Item Errors</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Cost Item</th>
                                    <th>Error</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="error-row">
                                    <td>Salmon Creek</td>
                                    <td>Ecologist II - Site Work</td>
                                    <td style="color: #dc2626;">No Generic Resource selected</td>
                                    <td><button class="btn btn-sm">Fix</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Assignment Errors</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Assignment</th>
                                    <th>Error</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="error-row">
                                    <td>David Kim</td>
                                    <td>Cascade Stream - Week of 8/12</td>
                                    <td style="color: #dc2626;">Hours assigned (50) exceed weekly capacity (40)</td>
                                    <td><button class="btn btn-sm">Fix</button></td>
                                </tr>
                                <tr class="error-row">
                                    <td>Jennifer Walsh</td>
                                    <td>Salmon Creek - Week of 8/19</td>
                                    <td style="color: #dc2626;">Assignment date before Work Item start date</td>
                                    <td><button class="btn btn-sm">Fix</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Copy Project Modal -->
            <div id="pm-copy-project" class="sub-view">
                <div class="panel">
                    <h2>📄 Copy Project (2-Step Process)</h2>
                    <button class="btn btn-secondary" onclick="showSubView('pm-projects-dashboard')">← Back to Dashboard</button>
                    
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <strong>Step 1:</strong> Find and select a source project using filters
                    </div>

                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h3>Search for Source Project</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">Name</label>
                                <input type="text" class="form-control" placeholder="Project name..." />
                            </div>
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">Delivery Method</label>
                                <select class="form-control">
                                    <option>All</option>
                                    <option>Design-Build</option>
                                    <option>Advisory Services</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn" style="margin-top: 12px;">Search</button>

                        <h4 style="margin-top: 20px;">Matching Projects</h4>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Number</th>
                                        <th>PM</th>
                                        <th>Budget</th>
                                        <th>Select</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Test 1130</td>
                                        <td>141</td>
                                        <td>Dustin W Romero</td>
                                        <td>$51,740</td>
                                        <td><button class="btn btn-sm">Select →</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>Step 2:</strong> Configure new project settings and copy options
                    </div>

                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h3>New Project Settings</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">New Project Name</label>
                                <input type="text" class="form-control" value="Copy of Test 1130" />
                            </div>
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">PM</label>
                                <select class="form-control">
                                    <option>Sarah Chen</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">Start Date</label>
                                <input type="date" class="form-control" />
                            </div>
                            <div>
                                <label style="font-weight: 500; margin-bottom: 4px; display: block;">Budget Multiplier (%)</label>
                                <input type="number" class="form-control" value="100" />
                            </div>
                        </div>

                        <h4 style="margin-top: 20px;">Copy Options</h4>
                        <div style="margin-top: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
                                <input type="checkbox" checked />
                                <span>Copy Work Items</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
                                <input type="checkbox" checked />
                                <span>Copy Cost Items</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; margin: 8px 0;">
                                <input type="checkbox" />
                                <span>Copy Milestones</span>
                            </label>
                        </div>

                        <button class="btn btn-success" style="margin-top: 20px;">Create Copy</button>
                    </div>
                </div>
            </div>

            <!-- Project Details -->
            <div id="project-details" class="sub-view">
                <div class="project-details-card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
                        <div>
                            <h2 style="margin: 0;">Salmon Creek Restoration</h2>
                            <div style="color: #64748b; margin-top: 4px;">PRJI00004 • Pacific Northwest • Sarah Chen</div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn" onclick="alert('Pull/Sync Project with NetSuite')">🔄 Sync NetSuite</button>
                            <button class="btn btn-secondary" onclick="showSubView('pm-projects-dashboard'); hideSubNav()">← Back</button>
                        </div>
                    </div>

                    <div class="grid grid-3" style="margin-top: 20px;">
                        <div>
                            <h4>Project Info</h4>
                            <div style="margin-top: 8px;">
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">PM:</span>
                                    <strong>Sarah Chen</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Region:</span>
                                    <strong>Pacific Northwest</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">State:</span>
                                    <strong>OR</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Delivery Method:</span>
                                    <strong>Design-Build</strong>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4>Schedule</h4>
                            <div style="margin-top: 8px;">
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Start Date:</span>
                                    <strong>Jun 1, 2025</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">End Date:</span>
                                    <strong>Dec 31, 2026</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Days Complete:</span>
                                    <strong>73 / 214 (34%)</strong>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4>Budget</h4>
                            <div style="margin-top: 8px;">
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Total Budget:</span>
                                    <strong>$340,000</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Actual Costs:</span>
                                    <strong>$247,000</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin: 4px 0;">
                                    <span style="color: #64748b;">Variance:</span>
                                    <strong style="color: #059669;">-$93,000 (27%)</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn" onclick="alert('Check Budget Submission Status to Apollo')">💰 Check Budget Status</button>
                        <button class="btn btn-warning" onclick="alert('Send Budget to Apollo')">📤 Send Budget to Apollo</button>
                    </div>

                    <h3 style="margin-top: 24px;">Project Health: <strong style="color: #059669;">0.92</strong></h3>
                    <div class="progress-bar" style="height: 12px;">
                        <div class="progress-fill" style="width: 92%; background: #059669;"></div>
                    </div>

                    <h3 style="margin-top: 24px;">Upcoming Milestones</h3>
                    <div style="background: white; padding: 16px; border-radius: 8px; margin-top: 12px;">
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e2e8f0;">
                            <div><div class="milestone-diamond"></div><strong>Permit Review Complete</strong></div>
                            <div>Aug 12, 2025 • $15,000</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                            <div><div class="milestone-diamond"></div><strong>Construction Phase Start</strong></div>
                            <div>Sep 1, 2025 • $25,000</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Work Items -->
            <div id="work-items" class="sub-view">
                <div class="panel">
                    <h2>🏗️ Work Items & Milestones</h2>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button class="btn" onclick="alert('Add Work Item - Multi-pane form (Must Have V1)')">+ Add Work Item</button>
                        <button class="btn btn-secondary" onclick="alert('Add Milestone')">+ Add Milestone</button>
                        <button class="btn btn-warning" onclick="alert('Bulk Add Cost Items')">⚡ Bulk Add Costs</button>
                        <button class="btn btn-success" onclick="showSubView('timeline')">📊 Timeline View</button>
                        <button class="btn" onclick="alert('Sync Task Change Requests to NetSuite')">🔄 Sync TCRs</button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Type</th>
                                    <th>Dates</th>
                                    <th>Status</th>
                                    <th>Budget</th>
                                    <th>Actual</th>
                                    <th>Variance</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #f8fafc; font-weight: 600;">
                                    <td>📁 Phase: Planning & Permitting</td>
                                    <td>Phase</td>
                                    <td>Jun 1 - Sep 30</td>
                                    <td><span class="status-badge status-in-progress">In Progress</span></td>
                                    <td>$125,000</td>
                                    <td>$98,750</td>
                                    <td style="color: #059669;">-$26,250</td>
                                    <td><button class="btn btn-sm" onclick="toggleDetails('phase-1')">Details</button></td>
                                </tr>
                                <tr id="phase-1-details" style="display: none;">
                                    <td colspan="8" style="background: #f8fafc; padding: 20px;">
                                        <div class="grid grid-3">
                                            <div>
                                                <h4>Financial</h4>
                                                <p>Budget: $125,000<br>Actual: $98,750<br>Variance: <strong style="color: #059669;">-$26,250 (21% under)</strong></p>
                                            </div>
                                            <div>
                                                <h4>Schedule</h4>
                                                <p>Duration: 122 days<br>Complete: 73 days (60%)<br>Remaining: 49 days</p>
                                            </div>
                                            <div>
                                                <h4>Resources</h4>
                                                <p>Cost Items: 12<br>Requests: 8 (6 filled)<br>Total Hours: 840 hrs</p>
                                            </div>
                                        </div>
                                        <button class="btn btn-sm">Edit</button>
                                        <button class="btn btn-sm btn-secondary" onclick="showSubView('cost-items')">View Cost Items</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>&nbsp;&nbsp;📋 Task: Site Assessment</td>
                                    <td>Task</td>
                                    <td>Jun 1 - Jul 15</td>
                                    <td><span class="status-badge status-complete">Complete</span></td>
                                    <td>$45,000</td>
                                    <td>$42,100</td>
                                    <td style="color: #059669;">-$2,900</td>
                                    <td><button class="btn btn-sm">Details</button></td>
                                </tr>
                                <tr style="background: #fef3c7;">
                                    <td>&nbsp;&nbsp;&nbsp;&nbsp;<div class="milestone-diamond"></div>Milestone: Permit Review Complete</td>
                                    <td>Milestone</td>
                                    <td>Aug 12</td>
                                    <td><span class="status-badge status-not-started">Pending</span></td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>$15,000</td>
                                    <td><button class="btn btn-sm">Details</button></td>
                                </tr>
                                <tr>
                                    <td>&nbsp;&nbsp;📋 Task: Environmental Impact Assessment</td>
                                    <td>Task</td>
                                    <td>Jul 1 - Sep 15</td>
                                    <td><span class="status-badge status-in-progress">In Progress</span></td>
                                    <td>$60,000</td>
                                    <td>$42,000</td>
                                    <td style="color: #059669;">-$18,000</td>
                                    <td><button class="btn btn-sm">Details</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Milestones -->
            <div id="milestones" class="sub-view">
                <div class="panel">
                    <h2>💎 Milestones - Salmon Creek Restoration</h2>
                    
                    <div class="alert alert-info">
                        Milestones are stored separately in database but displayed integrated with Work Items
                    </div>

                    <h3>Milestones Table</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Parent Work Item</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fef3c7;">
                                    <td><div class="milestone-diamond"></div>Permit Review Complete</td>
                                    <td>Aug 12, 2025</td>
                                    <td>$15,000</td>
                                    <td>Planning & Permitting</td>
                                    <td><span class="status-badge status-not-started">Pending</span></td>
                                    <td><button class="btn btn-sm">Edit</button></td>
                                </tr>
                                <tr style="background: #fef3c7;">
                                    <td><div class="milestone-diamond"></div>Construction Phase Start</td>
                                    <td>Sep 1, 2025</td>
                                    <td>$25,000</td>
                                    <td>Construction</td>
                                    <td><span class="status-badge status-not-started">Upcoming</span></td>
                                    <td><button class="btn btn-sm">Edit</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 style="margin-top: 32px;">Milestones Timeline</h3>
                    <div class="alert alert-success">
                        <strong>Visual Timeline:</strong> Gantt-style view of all milestones (Similar to Image #7)
                    </div>
                </div>
            </div>

            <!-- Timeline -->
            <div id="timeline" class="sub-view">
                <div class="panel">
                    <h2>📊 Gantt Timeline - Work Items & Milestones</h2>
                    <button class="btn btn-secondary" onclick="showSubView('work-items')">← Back to Table View</button>
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <strong>Gantt Chart:</strong> Visual timeline of all work items and milestones (Image #4)
                    </div>
                </div>
            </div>

            <!-- Cost Items -->
            <div id="cost-items" class="sub-view">
                <div class="panel">
                    <h2>💰 Cost Items</h2>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                        <button class="btn" onclick="alert('Add Cost Item creates Resource Request if Labor/Equipment')">+ Add Cost Item</button>
                        <button class="btn btn-success" onclick="showSubView('cost-timeline')">📈 Cost Timeline View</button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Type</th>
                                    <th>Work Item</th>
                                    <th>Generic Resource</th>
                                    <th>Hours</th>
                                    <th>Rate</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Labor</strong></td>
                                    <td>Resource Request</td>
                                    <td>Site Assessment</td>
                                    <td>Ecologist I</td>
                                    <td>80</td>
                                    <td>$85/hr</td>
                                    <td>$6,800</td>
                                    <td><span class="status-badge status-complete">Filled</span></td>
                                </tr>
                                <tr style="background: #fef3c7;">
                                    <td><strong>Labor</strong></td>
                                    <td>Resource Request</td>
                                    <td>Environmental Impact</td>
                                    <td>Ecologist II</td>
                                    <td>120</td>
                                    <td>$120/hr</td>
                                    <td>$14,400</td>
                                    <td><span class="status-badge status-not-started">Unfilled</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Vendor/Subcontractor</strong></td>
                                    <td>External</td>
                                    <td>Site Assessment</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>$15,000</td>
                                    <td><span class="status-badge status-complete">Invoiced</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Cost Timeline -->
            <div id="cost-timeline" class="sub-view">
                <div class="panel">
                    <h2>📈 Cost Items Timeline</h2>
                    <button class="btn btn-secondary" onclick="showSubView('cost-items')">← Back to Table View</button>
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <strong>Cost Timeline:</strong> Gantt-style view of all cost items over time (Image #6)
                    </div>
                </div>
            </div>

            <!-- Resource Requests -->
            <div id="resource-requests" class="sub-view">
                <div class="panel">
                    <h2>📝 Resource Requests</h2>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Work Item</th>
                                    <th>Generic Resource</th>
                                    <th>Hours</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Status</th>
                                    <th>Assigned To</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>RR-001</td>
                                    <td>Site Assessment</td>
                                    <td>Ecologist I</td>
                                    <td>80 hrs</td>
                                    <td>Jun 1</td>
                                    <td>Jul 15</td>
                                    <td><span class="status-badge status-complete">Filled</span></td>
                                    <td>Jennifer Walsh</td>
                                </tr>
                                <tr style="background: #fef3c7;">
                                    <td>RR-002</td>
                                    <td>Environmental Impact</td>
                                    <td>Ecologist II</td>
                                    <td>120 hrs</td>
                                    <td>Jul 1</td>
                                    <td>Sep 15</td>
                                    <td><span class="status-badge status-not-started">Unfilled</span></td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Assignments -->
            <div id="assignments" class="sub-view">
                <div class="panel">
                    <h2>👥 Assignments</h2>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Work Item</th>
                                    <th>Week Starting</th>
                                    <th>Hours Assigned</th>
                                    <th>Hours Used</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Jennifer Walsh</td>
                                    <td>Site Assessment</td>
                                    <td>Jun 1</td>
                                    <td>20 hrs</td>
                                    <td>18 hrs</td>
                                    <td><span class="status-badge status-complete">Complete</span></td>
                                </tr>
                                <tr>
                                    <td>Jennifer Walsh</td>
                                    <td>Environmental Impact</td>
                                    <td>Aug 12</td>
                                    <td>24 hrs</td>
                                    <td>12 hrs</td>
                                    <td><span class="status-badge status-in-progress">In Progress</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Contract History -->
            <div id="contract-history" class="sub-view">
                <div class="panel">
                    <h2>📄 Contract History & Change Orders</h2>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Jun 1, 2025</td>
                                    <td>Original Contract</td>
                                    <td>Initial project contract</td>
                                    <td>$340,000</td>
                                    <td><span class="status-badge status-complete">Signed</span></td>
                                </tr>
                                <tr>
                                    <td>Jul 15, 2025</td>
                                    <td>Change Order #1</td>
                                    <td>Additional environmental surveys</td>
                                    <td>+$25,000</td>
                                    <td><span class="status-badge status-in-progress">Pending</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Task Change Requests -->
            <div id="task-changes" class="sub-view">
                <div class="panel">
                    <h2>🔄 Task Change Requests (TCRs)</h2>
                    
                    <div class="alert alert-success">
                        <strong>Status:</strong> Done in Coda - QA Requested • Needs thorough testing
                    </div>

                    <div class="alert alert-info">
                        <strong>Workflow:</strong> When work items synced to NetSuite are edited, TCRs are created and must be approved before changes sync
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>TCR ID</th>
                                    <th>Work Item</th>
                                    <th>Change Type</th>
                                    <th>Requested By</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>TCR-2025-001</td>
                                    <td>Site Assessment</td>
                                    <td>Date Change</td>
                                    <td>Sarah Chen</td>
                                    <td>Aug 10</td>
                                    <td><span class="status-badge status-in-progress">Pending Approval</span></td>
                                    <td><button class="btn btn-sm">View Details</button></td>
                                </tr>
                                <tr>
                                    <td>TCR-2025-002</td>
                                    <td>Environmental Impact</td>
                                    <td>Budget Adjustment</td>
                                    <td>Sarah Chen</td>
                                    <td>Aug 9</td>
                                    <td><span class="status-badge status-complete">Approved</span></td>
                                    <td><button class="btn btn-sm">View Details</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>

        <!-- RM ROLE VIEW -->
        <div id="rm-view" class="role-view">
            <div class="panel">
                <h2>👥 Resource Manager Dashboard</h2>
                <div class="alert alert-info">
                    <strong>RM: Mike Rodriguez</strong> • Ecology Department • Pacific Northwest
                </div>

                <h3>Select a view:</h3>
                <div class="menu-list">
                    <div class="menu-item" onclick="showRMView('unfilled-requests')">
                        <h3>📋 Unfilled Resource Requests</h3>
                        <p style="color: #64748b; margin-top: 8px;">Review and assign staff to open requests</p>
                    </div>
                    <div class="menu-item" onclick="showRMView('resource-gantt')">
                        <h3>📊 Resource Gantt View</h3>
                        <p style="color: #64748b; margin-top: 8px;"><strong>Bailey's critical feature</strong> - Visual timeline of all assignments</p>
                    </div>
                    <div class="menu-item" onclick="showRMView('capacity-planning')">
                        <h3>📈 Capacity Planning</h3>
                        <p style="color: #64748b; margin-top: 8px;">Weekly capacity tracking with over-allocation warnings</p>
                    </div>
                    <div class="menu-item" onclick="showRMView('crews-management')">
                        <h3>👥 Crews Management</h3>
                        <p style="color: #64748b; margin-top: 8px;">Actual Resource Template System - Must Have V1</p>
                    </div>
                    <div class="menu-item" onclick="showRMView('assignments-overview')">
                        <h3>🗓️ Assignments Overview</h3>
                        <p style="color: #64748b; margin-top: 8px;">All current and future assignments</p>
                    </div>
                    <div class="menu-item" onclick="showRMView('progress-reports')">
                        <h3>📋 Progress Reports</h3>
                        <p style="color: #64748b; margin-top: 8px;">Review employee progress updates</p>
                    </div>
                </div>
            </div>

            <!-- RM Sub-views -->
            <div id="rm-unfilled-requests" style="display: none;">
                <div class="panel">
                    <h2>📋 Unfilled Resource Requests</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                    
                    <div class="table-container" style="margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Project</th>
                                    <th>Work Item</th>
                                    <th>Generic Resource</th>
                                    <th>Hours</th>
                                    <th>Start Date</th>
                                    <th>Priority</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Salmon Creek Restoration</td>
                                    <td>Environmental Impact Assessment</td>
                                    <td>Ecologist II</td>
                                    <td>120 hrs</td>
                                    <td>Jul 1</td>
                                    <td><span class="status-badge status-blocked">High</span></td>
                                    <td><button class="btn btn-sm" onclick="alert('Assign Resource Modal:\n\n• Select Employee: [dropdown]\n• Create Weekly Assignments\n• Week Starting | Hours\n• Jul 1 | 40\n• Jul 8 | 40\n• Jul 15 | 40\n\n• Capacity Validation: Shows over-allocation warning if needed\n\n[Confirm Assignment]')">Assign</button></td>
                                </tr>
                                <tr>
                                    <td>Cascade Stream Enhancement</td>
                                    <td>Site Assessment</td>
                                    <td>Ecologist I</td>
                                    <td>80 hrs</td>
                                    <td>Aug 15</td>
                                    <td><span class="status-badge status-in-progress">Medium</span></td>
                                    <td><button class="btn btn-sm">Assign</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="rm-resource-gantt" style="display: none;">
                <div class="panel">
                    <h2>📊 Resource Gantt View</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                    <div class="alert alert-success" style="margin-top: 20px;">
                        <strong>Bailey's Critical Feature - Must Have V1:</strong> "Cannot do my job without this"<br><br>
                        Visual Gantt chart showing all staff assignments across projects over time<br>
                        • Horizontal axis: Time (weeks/months)<br>
                        • Vertical axis: Employees<br>
                        • Bars: Assignment duration colored by project<br>
                        • Hover: Shows project, hours, task details<br>
                        • Drag to reschedule assignments
                    </div>
                </div>
            </div>

            <div id="rm-capacity-planning" style="display: none;">
                <div class="panel">
                    <h2>📈 Capacity Planning</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                    
                    <div class="table-container" style="margin-top: 20px;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Staff Member</th>
                                    <th>Week of Aug 12</th>
                                    <th>Capacity</th>
                                    <th>Status</th>
                                    <th>Projects</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fee2e2;">
                                    <td><strong>Jennifer Walsh</strong></td>
                                    <td><strong>52 hrs</strong></td>
                                    <td>40 hrs/week</td>
                                    <td style="color: #dc2626;"><strong>Over-allocated (+12 hrs)</strong></td>
                                    <td>Salmon Creek (24h), Cascade (20h), Willow (8h)</td>
                                </tr>
                                <tr>
                                    <td><strong>David Kim</strong></td>
                                    <td>38 hrs</td>
                                    <td>40 hrs/week</td>
                                    <td style="color: #059669;">Available (2 hrs)</td>
                                    <td>Cascade Stream (38h)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="rm-crews-management" style="display: none;">
                <div class="panel">
                    <h2>👥 Crews Management</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                    <div class="alert alert-info" style="margin-top: 20px;">
                        <strong>Actual Resource Template System - Must Have V1 (In Progress)</strong><br><br>
                        Create crew templates for grouped resource assignments<br>
                        • Define crew composition (e.g., "Field Survey Crew": 1 Ecologist II, 2 Ecologist I)<br>
                        • Assign entire crew to requests with one action<br>
                        • Track crew availability and scheduling
                    </div>
                </div>
            </div>

            <div id="rm-assignments-overview" style="display: none;">
                <div class="panel">
                    <h2>🗓️ Assignments Overview</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                </div>
            </div>

            <div id="rm-progress-reports" style="display: none;">
                <div class="panel">
                    <h2>📋 Progress Reports Review</h2>
                    <button class="btn btn-secondary" onclick="showRMView('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>

        <!-- EMPLOYEE ROLE VIEW -->
        <div id="employee-view" class="role-view">
            <div class="panel">
                <h2>👤 Employee Dashboard - Jennifer Walsh</h2>
                
                <div class="grid grid-4">
                    <div class="stat-card">
                        <h4>This Week's Hours</h4>
                        <div class="value" style="color: #dc2626;">52</div>
                        <small>12 hrs over capacity</small>
                    </div>
                    <div class="stat-card">
                        <h4>Active Projects</h4>
                        <div class="value">4</div>
                    </div>
                    <div class="stat-card">
                        <h4>Pending Tasks</h4>
                        <div class="value" style="color: #d97706;">7</div>
                    </div>
                    <div class="stat-card">
                        <h4>Completion Rate</h4>
                        <div class="value" style="color: #059669;">94%</div>
                    </div>
                </div>

                <h3>📅 Weekly Schedule</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Project</th>
                                <th>Work Item</th>
                                <th>Hours</th>
                                <th>Status</th>
                                <th>Submit Report</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Salmon Creek Restoration</td>
                                <td>Environmental Impact Assessment</td>
                                <td>24 hrs</td>
                                <td><span class="status-badge status-in-progress">On Schedule</span></td>
                                <td><button class="btn btn-sm" onclick="alert('Progress Report Form:\n\n• Status:\n  ○ On Schedule\n  ○ Behind Schedule\n  ○ Ahead of Schedule\n  ○ Blocked\n\n• Progress Notes: [text area]\n\n• Request Hour Adjustment:\n  ☑ Need more time\n  Current: 24 hrs → New: [32] hrs\n  Reason: [text area]\n\n• Request Early Completion:\n  ☐ Task will complete early\n\n[Submit Report]')">+ Report</button></td>
                            </tr>
                            <tr>
                                <td>Cascade Stream Enhancement</td>
                                <td>Site Assessment</td>
                                <td>20 hrs</td>
                                <td><span class="status-badge status-in-progress">On Schedule</span></td>
                                <td><button class="btn btn-sm">+ Report</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- LEADERSHIP ROLE VIEW -->
        <div id="leadership-view" class="role-view">
            <div class="panel">
                <h2>📈 Leadership Dashboard - Company Overview</h2>
                
                <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select class="form-control" style="width: auto;">
                        <option>All Regions</option>
                        <option>Pacific Northwest</option>
                        <option>California</option>
                        <option>Southeast</option>
                    </select>
                    <select class="form-control" style="width: auto;">
                        <option>All PMs</option>
                        <option>Sarah Chen</option>
                        <option>Michael Torres</option>
                    </select>
                </div>

                <div class="grid grid-4">
                    <div class="stat-card">
                        <h4>Active Projects</h4>
                        <div class="value">2,847</div>
                        <small>Across all regions</small>
                    </div>
                    <div class="stat-card">
                        <h4>Total Budget</h4>
                        <div class="value">$287M</div>
                        <small>YTD</small>
                    </div>
                    <div class="stat-card">
                        <h4>Avg. Project Health</h4>
                        <div class="value" style="color: #059669;">87/100</div>
                        <small>Company-wide</small>
                    </div>
                    <div class="stat-card">
                        <h4>Resource Utilization</h4>
                        <div class="value">82%</div>
                        <small>All departments</small>
                    </div>
                </div>

                <h3>Project Health by Region</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Region</th>
                                <th># Projects</th>
                                <th>Total Budget</th>
                                <th>Avg. Health</th>
                                <th>Over Budget</th>
                                <th>Utilization</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Pacific Northwest</strong></td>
                                <td>267</td>
                                <td>$47.2M</td>
                                <td style="color: #059669;">92/100</td>
                                <td>33 projects</td>
                                <td>87%</td>
                            </tr>
                            <tr>
                                <td><strong>California</strong></td>
                                <td>312</td>
                                <td>$58.4M</td>
                                <td style="color: #059669;">89/100</td>
                                <td>41 projects</td>
                                <td>84%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Upcoming Cash Collections (Next 60 Days)</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Due Date</th>
                                <th>Milestone</th>
                                <th>Project</th>
                                <th>Region</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Aug 15, 2025</td>
                                <td>Q2 Invoice Submission</td>
                                <td>Coastal Habitat Enhancement</td>
                                <td>Pacific Northwest</td>
                                <td>$125,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ADMIN ROLE VIEW -->
        <div id="admin-view" class="role-view">
            <div class="panel">
                <h2>⚙️ Admin Settings</h2>

                <h3>Billing Rates by Generic Resource</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Resource Type</th>
                                <th>Rate</th>
                                <th>Department</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ecologist I</td>
                                <td>$85/hr</td>
                                <td>Ecology</td>
                                <td><button class="btn btn-sm">Edit</button></td>
                            </tr>
                            <tr>
                                <td>Ecologist II</td>
                                <td>$120/hr</td>
                                <td>Ecology</td>
                                <td><button class="btn btn-sm">Edit</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 style="margin-top: 32px;">System Configuration</h3>
                <div class="grid grid-2">
                    <div class="panel" style="background: #f8fafc;">
                        <h4>Alert Thresholds</h4>
                        <div style="margin-top: 12px;">
                            <div style="margin-bottom: 12px;">
                                <label style="font-weight: 500;">Budget Warning (%)</label>
                                <input type="number" class="form-control" value="85" style="margin-top: 4px;" />
                            </div>
                            <div style="margin-bottom: 12px;">
                                <label style="font-weight: 500;">Over-allocation (hrs/week)</label>
                                <input type="number" class="form-control" value="45" style="margin-top: 4px;" />
                            </div>
                            <button class="btn">Save</button>
                        </div>
                    </div>
                    <div class="panel" style="background: #f8fafc;">
                        <h4>User Management</h4>
                        <p style="color: #64748b; margin-top: 8px;">Create, edit, and manage user accounts and permissions</p>
                        <button class="btn" style="margin-top: 12px;">Manage Users</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- DEV ROLE VIEW -->
        <div id="dev-view" class="role-view">
            <div class="panel">
                <h2>🔧 Technical Documentation</h2>
                
                <div class="alert alert-info">
                    <strong>Architecture:</strong> Custom JavaScript UI → Supabase Backend → NetSuite/Apollo Integration
                </div>

                <h3>Data Storage Strategy</h3>
                <div class="grid grid-2">
                    <div class="panel" style="background: #f0fdf4; border-left: 4px solid #059669;">
                        <h4>Supabase (Official Record)</h4>
                        <ul style="margin-left: 20px;">
                            <li>Projects</li>
                            <li>Work Items (even unsent to NetSuite)</li>
                            <li>Milestones (separate table, displayed with Work Items)</li>
                            <li>Cost Items</li>
                            <li>Assignments</li>
                            <li>Progress Reports</li>
                            <li>Contract History</li>
                            <li>Generic Resource Rates</li>
                        </ul>
                    </div>
                    <div class="panel" style="background: #fef2f2; border-left: 4px solid #dc2626;">
                        <h4>NetSuite (Official Record)</h4>
                        <ul style="margin-left: 20px;">
                            <li>Projects (master data)</li>
                            <li>Work Items (basic: Name, Dates)</li>
                            <li>Employees</li>
                            <li>Vendors</li>
                            <li>Project Actuals</li>
                            <li>Regions, States, Delivery Methods</li>
                            <li>WBS Templates</li>
                        </ul>
                    </div>
                </div>

                <h3>Key Workflows</h3>
                <div class="panel" style="background: #f8fafc;">
                    <h4>1. Project Creation</h4>
                    <p style="color: #64748b;">
                        PM clicks "+ New Project" → Fills details → Saves to Supabase → Optionally syncs to NetSuite → Auto-navigates to Project Details
                    </p>
                </div>

                <div class="panel" style="background: #f8fafc;">
                    <h4>2. Resource Request & Assignment</h4>
                    <p style="color: #64748b;">
                        PM adds Labor/Equipment cost item → Creates resource request → RM views unfilled requests → Assigns employee → System validates capacity → Warns if over-allocated → Assignment saved → Request marked "Filled"
                    </p>
                </div>

                <div class="panel" style="background: #f8fafc;">
                    <h4>3. Progress Reporting</h4>
                    <p style="color: #64748b;">
                        Employee submits progress report → PM/RM reviews → Approves/denies adjustments → If approved: Future assignments auto-adjusted → Employee notified
                    </p>
                </div>

                <div class="panel" style="background: #f8fafc;">
                    <h4>4. NetSuite Sync</h4>
                    <p style="color: #64748b;">
                        PM creates/edits work items → Saves to Supabase → Clicks "Sync to NetSuite" → Sends to Apollo API → NetSuite returns IDs → For updates: Creates Task Change Request → Tracks TCR status → When approved: Pulls latest data
                    </p>
                </div>
            </div>
        </div>

    </div>

    <script>
        let selectedProject = { id: null, name: null };

        function showRole(roleId) {
            document.querySelectorAll('.role-view').forEach(view => view.classList.remove('active'));
            document.querySelectorAll('.main-nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(roleId + '-view').classList.add('active');
            event.target.classList.add('active');

            if (roleId !== 'pm' || !selectedProject.id) {
                document.getElementById('project-sub-nav').classList.remove('active');
            }

            if (roleId === 'rm') {
                showRMView('menu');
            }
        }

        function selectProject(projectId, projectName) {
            selectedProject.id = projectId;
            selectedProject.name = projectName;
            
            document.getElementById('selected-project-name').textContent = `${projectName} (${projectId})`;
            document.getElementById('project-sub-nav').classList.add('active');
            document.getElementById('pm-projects-dashboard').classList.remove('active');
            
            showSubView('project-details');
        }

        function hideSubNav() {
            document.getElementById('project-sub-nav').classList.remove('active');
            selectedProject = { id: null, name: null };
        }

        function showSubView(viewId) {
            document.querySelectorAll('#pm-view .sub-view').forEach(view => view.classList.remove('active'));
            document.querySelectorAll('.sub-nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(viewId).classList.add('active');
            
            if (event && event.target.classList.contains('sub-nav-tab')) {
                event.target.classList.add('active');
            }

            if (viewId === 'pm-projects-dashboard') {
                hideSubNav();
            }
        }

        function showRMView(viewId) {
            if (viewId === 'menu') {
                document.querySelector('#rm-view > .panel').style.display = 'block';
                document.querySelectorAll('#rm-view > div:not(.panel)').forEach(view => view.style.display = 'none');
            } else {
                document.querySelector('#rm-view > .panel').style.display = 'none';
                document.querySelectorAll('#rm-view > div:not(.panel)').forEach(view => view.style.display = 'none');
                document.getElementById('rm-' + viewId).style.display = 'block';
            }
        }

        function toggleFavorite(event) {
            const btn = event.target;
            if (btn.textContent === '⭐') {
                btn.textContent = '☆';
                btn.style.color = '#d1d5db';
            } else {
                btn.textContent = '⭐';
                btn.style.color = '#f59e0b';
            }
        }

        function toggleDetails(itemId) {
            const detailRow = document.getElementById(itemId + '-details');
            if (detailRow.style.display === 'none') {
                detailRow.style.display = 'table-row';
            } else {
                detailRow.style.display = 'none';
            }
        }
    </script>
</body>
</html>